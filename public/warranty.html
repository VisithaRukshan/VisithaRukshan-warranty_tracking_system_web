<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Warranty Tracking System</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://kit.fontawesome.com/b99e675b6e.js"></script>
</head>

<body>
  <div class="wrapper">
    <div class="sidebar">
      <div class="vWhitespace2"></div>
      <ul>
        <li><a href="user.html"><i class="fas fa-users"></i>Users</a></li>
        <li style="background-color: #594f8d"><a href="warranty.html" style="color: #fff"><i
              class="fas fa-calendar-check"></i>Warranty</a></li>
        <li><a href="products.html"><i class="fas fa-store"></i></i>Products</a></li>
        <li><a href="notifications.html"><i class="fas fa-bell"></i>Notifications</a></li>
      </ul>
      <div class="social_media">
        <p style="text-align:center ; color: #fff ; font-size: smaller">v1.0.0<br>All Rights Reserved</p>
      </div>
    </div>
    <div class="main_content">
      <div class="header">Warranty</div>
      <div class="info">
        <div class="card3">
          <table id="table">
            <thead>
              <th>Model</th>
              <th>Serial No.</th>
              <th>Warranty Start Date</th>
              <th>Warranty End Date</th>
              <th>Contact No.</th>
              <th>Address</th>
              <th>Vehicle Model</th>
            </thead>
            <tbody id="tbody1"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <!-------------------Imports and configurations--------------------->
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-app.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBYdsJ-W7kQj2ZUwx0NM5vHkjPtp7LwiIs",
      authDomain: "warrantyclaimsystem.firebaseapp.com",
      projectId: "warrantyclaimsystem",
      storageBucket: "warrantyclaimsystem.appspot.com",
      messagingSenderId: "862487188628",
      appId: "1:862487188628:web:36cb11e350055a11cc1081"
    };


    import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-auth.js";
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);

    //const auth = firebase.auth();

    import {
      getFirestore, doc, getDoc, getDocs, setDoc, collection, addDoc
    }
      from "https://www.gstatic.com/firebasejs/9.6.6/firebase-firestore.js";




    const db = getFirestore();


    window.onload = GetAllDataOnce();

    /*  setTimeout(function () {
        window.location.reload(1);
      }, 10000);*/

    setInterval(function () {
      GetAllDataOnce();
    }, 10000);
    //-----------------Reference---------------------//

    var tbody = document.getElementById('tbody1');

    //---------------Filling data to the table----------------//

    function AddItemToTable(M, SNo, WSD, WED, Cno, Add, VM) {
      let trow = document.createElement("tr");
      let td1 = document.createElement('td');
      let td2 = document.createElement('td');
      let td3 = document.createElement('td');
      let td4 = document.createElement('td');
      let td5 = document.createElement('td');
      let td6 = document.createElement('td');
      let td7 = document.createElement('td');

      td1.innerHTML = M;
      td2.innerHTML = SNo;
      td3.innerHTML = WSD;
      td4.innerHTML = WED;
      td5.innerHTML = Cno;
      td6.innerHTML = Add;
      td7.innerHTML = VM;

      trow.appendChild(td1);
      trow.appendChild(td2);
      trow.appendChild(td3);
      trow.appendChild(td4);
      trow.appendChild(td5);
      trow.appendChild(td6);
      trow.appendChild(td7);

      tbody.appendChild(trow);
      //console.log(tbody);
    }


    function AddAllItemsToTable(ActivatedWarranty) {
      tbody.innerHTML = "";
      ActivatedWarranty.forEach(element => {
        AddItemToTable(element.model, element.sNo, element.activationDate, element.warrantyExpireDate, element.mobileNo, element.address, element.vehicleModel);
      });
    }


    async function GetAllDataOnce() {
      const querySnapShot = await getDocs(collection(db, "ActivatedWarranty"));
      var ActivatedWarranty = [];

      querySnapShot.forEach(doc => {
        ActivatedWarranty.push(doc.data());
      });

      AddAllItemsToTable(ActivatedWarranty);
    }

  </script>

</body>


</html>